function loadTop10(){let n=startDateElement.val(),t=lastDateElement.val();let i="";n==""&&t!=""?i=`?startDate=${"0001-01-01"}&lastDate=${t}`:n!=""&&t==""?i=`?startDate=${n}`:n!=""&&t!=""&&(i=`?startDate=${n}&lastDate=${t}`);let r="";$(usersRadio).prop("checked")?(r=topUsersBaseURL+i,getTop10(r,"Users")):$(projectsRadio).prop("checked")&&(r=topProjectsBaseURL+i,getTop10(r,"Projets"))}function showHours(){const n=$(this).attr("userid");$.ajax({url:"/Project/HoursByUser?userId="+n,type:"GET",success:function(n){let t,i={};$(n).each(function(n,r){t=r.userNames;i[r.projectName]=r.hours});let r="";$.each(i,function(n,t){let i=parseFloat(t).toFixed(2);r+=`<p>${n+" : "+i+"h"}</p>`});let u=new popup([{text:"Close"}],t,r);u.open()}})}function getUsersByPage(n){let t=startDateElement.val(),i=lastDateElement.val();let r="";t==""&&i!=""?r=`&startDate=${"0001-01-01"}&lastDate=${i}`:t!=""&&i==""?r=`&startDate=${t}`:t!=""&&i!=""&&(r=`&startDate=${t}&lastDate=${i}`);$.ajax({url:"/Home/AllUsers?id="+n+r,type:"GET",success:function(n){movePage(n);populateTable(n)}})}function populateTable(n){usersTable.html("");const t=n.usersForListing;$(t).each(function(){const n=document.createElement("tr"),i=document.createElement("td"),r=document.createElement("td"),u=document.createElement("td"),f=document.createElement("td"),e=document.createElement("td"),t=document.createElement("input");$(t).addClass("btn btn-primary btn-block hoursBtn");$(t).attr("type","button");$(t).attr("userid",this.id);$(t).val("View Project Hours");$(t).click(showHours);$(e).html(t);$(i).text(this.id);$(r).text(this.name);$(u).text(this.surname);$(f).text(this.email);$(n).append(i);$(n).append(r);$(n).append(u);$(n).append(f);$(n).append(e);$(usersTable).append(n)})}function movePage(n){n.hasPreviousPage?(prevContainer.removeClass("disabled"),fBtn.show()):(prevContainer.addClass("disabled"),fBtn.hide());n.hasNextPage?(nextContainer.removeClass("disabled"),tBtn.show(),console.log("ima")):(nextContainer.addClass("disabled"),tBtn.hide(),console.log("nqma"));currentPageBtn.text(n.pageNumber);fBtn.text(n.previousPageNumber);tBtn.text(n.nextPageNumber)}function popup(n,t,i){function y(){$("body").append(u);u.fadeIn(500);e=$("body").scrollTop();$("html").css({position:"fixed",top:-e})}function o(){u.fadeOut(200,function(){u.remove();$("html").css({position:"static",top:0});$("html, body").scrollTop(e)})}var f='<div class="popup_wrapper"><form class="popup">',r,u,v,e;if(t&&(f+='<h2 class="title">'+t+"<\/h2>"),i&&(f+=i),n){for(f+='<div class="buttons">',r=0;r<n.length;r++){var s=n[r]["class"]?" class="+n[r]["class"]:"",h=n[r].checkForm?" data-checkForm="+n[r].checkForm:"",c=n[r].close===!1?" data-close="+n[r].close:"",l=n[r].value!==undefined?" data-value="+n[r].value:"",a=n[r].text||"";f+="<button"+s+c+h+l+">"+a+"<\/button>"}f+="<\/div>"}f+="<\/form><\/div>";u=$(f);v=u.children("form");this.open=function(n){var t=$.Deferred();y();u.on("click",".buttons button",function(){o()});return t.progress(n)};this.close=function(){o()};this.addClass=function(n){$(u).addClass(n)};this.removeClass=function(n){$(u).removeClass(n)}}function getTop10(n,t){$.ajax({url:n,type:"GET",success:function(n){function i(){let i=[];$(n).each(function(n,t){let r=["",t.totalHours,"blue",t.fullName];i.push(r)});var r=google.visualization.arrayToDataTable([["Element","Hours",{role:"style"},{role:"annotation"}],["",populateEmptyFields(i[0],"number"),"green",populateEmptyFields(i[0],"string")],["",populateEmptyFields(i[1],"number"),"red",populateEmptyFields(i[1],"string")],["",populateEmptyFields(i[2],"number"),"blue",populateEmptyFields(i[2],"string")],["",populateEmptyFields(i[3],"number"),"orangered",populateEmptyFields(i[3],"string")],["",populateEmptyFields(i[4],"number"),"turquoise",populateEmptyFields(i[4],"string")],["",populateEmptyFields(i[5],"number"),"deeppink",populateEmptyFields(i[5],"string")],["",populateEmptyFields(i[6],"number"),"darkorange",populateEmptyFields(i[6],"string")],["",populateEmptyFields(i[7],"number"),"coral",populateEmptyFields(i[7],"string")],["",populateEmptyFields(i[8],"number"),"blanchedalmond",populateEmptyFields(i[8],"string")],["",populateEmptyFields(i[9],"number"),"aquamarine",populateEmptyFields(i[9],"string")],]),u={title:"Top 10 "+t,chartArea:{width:"100%"},colors:["#b0120a","#ffab91"],hAxis:{title:"Total Hours",minValue:0}},f=new google.visualization.BarChart(document.getElementById("chart_div"));f.draw(r,u)}google.charts.load("current",{packages:["corechart","bar"]});google.charts.setOnLoadCallback(i)}})}function populateEmptyFields(n,t){return n==undefined&&t=="number"?0:n==undefined&&t=="string"?"":n!=undefined&&t=="number"?n[1]:n!=undefined&&t=="string"?n[3]:void 0}function sortTable(n){let r=0;n=="byName"&&(r=1);for(var i,t,e,o,f,s=$("#usersTable"),u=!0;u;){for(u=!1,i=s.find("tr"),t=0;t<i.length-1;t++)if(f=!1,e=$(i[t]).find("td")[r],o=$(i[t+1]).find("td")[r],r==0){if(parseInt($(e).text())>parseInt($(o).text())){f=!0;break}}else if(r==1&&$(e).text().toLowerCase()>$(o).text().toLowerCase()){f=!0;break}f&&(i[t].parentNode.insertBefore(i[t+1],i[t]),u=!0)}}const fBtn=$("#FBtn"),tBtn=$("#TBtn"),currentPageBtn=$("#SBtn"),prevContainer=$("#prevContainer"),nextContainer=$("#nextContainer"),usersTable=$("#usersTable"),usersRadio=$("#usersRadio"),projectsRadio=$("#projectsRadio"),startDateElement=$("#startDate"),lastDateElement=$("#endDate"),filterButton=$("#filterButton"),topUsersBaseURL="/Home/GetTop10Users",topProjectsBaseURL="/Project/GetTop10Projects";$(document).ready(function(){fBtn.text()==0&&fBtn.hide();getTop10(topUsersBaseURL,"Users");$(function(){let n=$("input:radio[name=inlineRadioOptions]");n.is(":checked")===!1&&n.filter("[value=user]").prop("checked",!0)});$(function(){let n=$("input:radio[name=sortInlineRadioOptions]");n.is(":checked")===!1&&n.filter("[value=byId]").prop("checked",!0)});$("input:radio[name=sortInlineRadioOptions]").change(function(){var n=$(this).val();sortTable(n)});$("#clearButton").click(function(){startDateElement.val("");lastDateElement.val("");$(usersRadio).prop("checked")?getTop10(topUsersBaseURL,"Users"):$(projectsRadio).prop("checked")&&getTop10(topProjectsBaseURL,"Projets");getUsersByPage(1)});$("input:radio[name=inlineRadioOptions]").change(function(){loadTop10()});$("#filterButton").click(function(){loadTop10();getUsersByPage(1)});$(".hoursBtn").click(showHours);$("#PrevBtn").click(function(){const n=parseInt(currentPageBtn.text())-1;getUsersByPage(n)});$("#NextBtn").click(function(){const n=tBtn.text();getUsersByPage(n)});$("#FBtn").click(function(){const n=$(this).text();getUsersByPage(n)});$("#TBtn").click(function(){const n=$(this).text();getUsersByPage(n)})});